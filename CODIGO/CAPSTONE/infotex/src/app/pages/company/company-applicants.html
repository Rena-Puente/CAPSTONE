<section class="company-applicants">
  <header class="company-applicants__header">
    <div>
      <h2 class="company-applicants__title">Postulaciones recibidas</h2>
      <p class="company-applicants__subtitle">
        Mantén el seguimiento de las personas interesadas en tus ofertas.
      </p>
    </div>
  </header>

  <div *ngIf="loading()" class="company-applicants__alert company-applicants__alert--info" role="status">
    Cargando postulantes...
  </div>

  <div *ngIf="error()" class="company-applicants__alert company-applicants__alert--error" role="alert">
    {{ error() }}
  </div>

  <ng-container *ngIf="!loading() && !error()">
    <div *ngIf="applicants().length === 0" class="company-applicants__empty">
      Aún no hay postulantes para tus ofertas.
    </div>

    <div class="company-applicants__table-wrapper" *ngIf="applicants().length > 0">
      <table class="company-applicants__table">
        <thead>
          <tr>
            <th scope="col">Oferta</th>
            <th scope="col">Postulante</th>
            <th scope="col">Correo</th>
            <th scope="col">Perfil</th>
            <th scope="col">Estado</th>
            <th scope="col">Fecha</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let applicant of applicants()">
            <td data-title="Oferta">{{ applicant.offerTitle || ('Oferta #' + applicant.offerId) }}</td>
            <td data-title="Postulante">{{ applicant.applicantName || 'Sin nombre' }}</td>
            <td data-title="Correo">{{ applicant.applicantEmail || 'Sin correo' }}</td>
            <td data-title="Perfil">
              <ng-container *ngIf="buildProfileUrl(applicant) as profileUrl; else noProfile">
                <a
                  [href]="profileUrl"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="company-applicants__link"
                >
                  Ver perfil
                </a>
              </ng-container>
              <ng-template #noProfile>Sin perfil</ng-template>
            </td>
            <td data-title="Estado">{{ applicant.status || 'En revisión' }}</td>
            <td data-title="Fecha">{{ applicant.submittedAt ? (applicant.submittedAt | date: 'short') : '—' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </ng-container>
</section>
