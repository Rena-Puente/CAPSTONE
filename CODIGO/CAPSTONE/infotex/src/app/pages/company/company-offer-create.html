<section class="company-offer-create">
  <header class="company-offer-create__header">
    <h2 class="company-offer-create__title">Crear nueva oferta laboral</h2>
    <p class="company-offer-create__subtitle">
      Comparte una vacante detallada para atraer al mejor talento.
    </p>
  </header>

  <form [formGroup]="form" (ngSubmit)="submit()" novalidate class="company-offer-create__form">
    <div class="company-offer-create__field">
      <label for="offerTitle" class="company-offer-create__label">Título</label>
      <input
        type="text"
        id="offerTitle"
        class="company-offer-create__control"
        formControlName="title"
        [class.is-invalid]="shouldShowError('title')"
        placeholder="Ej. Diseñador UX Senior"
      />
      <div class="company-offer-create__error" *ngIf="getControlError('title')">
        {{ getControlError('title') }}
      </div>
    </div>

    <div class="company-offer-create__field">
      <label for="offerDescription" class="company-offer-create__label">Descripción</label>
      <textarea
        id="offerDescription"
        class="company-offer-create__control company-offer-create__control--textarea"
        rows="6"
        formControlName="description"
        [class.is-invalid]="shouldShowError('description')"
        placeholder="Detalla responsabilidades, beneficios y requisitos esenciales"
      ></textarea>
      <div class="company-offer-create__error" *ngIf="getControlError('description')">
        {{ getControlError('description') }}
      </div>
    </div>

    <div class="company-offer-create__grid">
      <div class="company-offer-create__field">
        <label for="offerLocationType" class="company-offer-create__label">Modalidad</label>
        <input
          type="text"
          id="offerLocationType"
          class="company-offer-create__control"
          formControlName="locationType"
          [class.is-invalid]="shouldShowError('locationType')"
          placeholder="Remoto, híbrido, presencial"
        />
        <div class="company-offer-create__error" *ngIf="getControlError('locationType')">
          {{ getControlError('locationType') }}
        </div>
      </div>

      <div class="company-offer-create__field">
        <label for="offerCity" class="company-offer-create__label">Ciudad</label>
        <input
          type="text"
          id="offerCity"
          class="company-offer-create__control"
          formControlName="city"
          [class.is-invalid]="shouldShowError('city')"
          placeholder="Ej. Santiago"
        />
        <div class="company-offer-create__error" *ngIf="getControlError('city')">
          {{ getControlError('city') }}
        </div>
      </div>

      <div class="company-offer-create__field">
        <label for="offerCountry" class="company-offer-create__label">País</label>
        <input
          type="text"
          id="offerCountry"
          class="company-offer-create__control"
          formControlName="country"
          [class.is-invalid]="shouldShowError('country')"
          placeholder="Ej. Chile"
        />
        <div class="company-offer-create__error" *ngIf="getControlError('country')">
          {{ getControlError('country') }}
        </div>
      </div>

      <div class="company-offer-create__field">
        <label for="offerSeniority" class="company-offer-create__label">Seniority</label>
        <ng-container *ngIf="!shouldUseSeniorityFallback(); else seniorityFallback">
          <select
            id="offerSeniority"
            class="company-offer-create__control"
            formControlName="seniority"
            [class.is-invalid]="shouldShowError('seniority')"
            [disabled]="seniorityLoading() || isSubmitting()"
            aria-label="Selecciona el nivel de seniority"
          >
            <option value="" disabled [selected]="!form.controls.seniority.value">
              {{ seniorityLoading() ? 'Cargando niveles disponibles...' : 'Selecciona un nivel' }}
            </option>
            <option *ngFor="let option of seniorityOptions()" [value]="option">{{ option }}</option>
          </select>
        </ng-container>
        <ng-template #seniorityFallback>
          <input
            type="text"
            id="offerSeniority"
            class="company-offer-create__control"
            formControlName="seniority"
            [class.is-invalid]="shouldShowError('seniority')"
            placeholder="Junior, Semi Senior, Senior"
          />
        </ng-template>
        <div class="company-offer-create__hint" *ngIf="seniorityLoading()">Cargando niveles de seniority...</div>
        <div class="company-offer-create__error" *ngIf="seniorityError()">{{ seniorityError() }}</div>
        <div class="company-offer-create__error" *ngIf="getControlError('seniority')">
          {{ getControlError('seniority') }}
        </div>
      </div>

      <div class="company-offer-create__field">
        <label for="offerContractType" class="company-offer-create__label">Tipo de contrato</label>
        <input
          type="text"
          id="offerContractType"
          class="company-offer-create__control"
          formControlName="contractType"
          [class.is-invalid]="shouldShowError('contractType')"
          placeholder="Indefinido, honorarios, plazo fijo"
        />
        <div class="company-offer-create__error" *ngIf="getControlError('contractType')">
          {{ getControlError('contractType') }}
        </div>
      </div>
    </div>

    <div class="company-offer-create__actions">
      <button type="submit" class="company-offer-create__submit" [disabled]="isSubmitting()">
        <span class="company-offer-create__spinner" *ngIf="isSubmitting()" role="status" aria-hidden="true"></span>
        Publicar oferta
      </button>

      <span class="company-offer-create__feedback company-offer-create__feedback--success" *ngIf="submitSuccess()">
        La oferta se creó correctamente.
      </span>
      <span class="company-offer-create__feedback company-offer-create__feedback--error" *ngIf="submitError()">
        {{ submitError() }}
      </span>
    </div>
  </form>
</section>
